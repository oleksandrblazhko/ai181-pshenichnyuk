# Відбиток Веб-Серверу

# Резюме

Відбитки веб-сервера — це завдання визначення типу та версії веб-сервера, на якому працює ціль. Хоча відбитки пальців
веб-сервера часто містяться в інструментах автоматизованого тестування, дослідникам важливо розуміти основи того, як ці
інструменти намагаються ідентифікувати програмне забезпечення, і чому це корисно.

Точне визначення типу веб-сервера, на якому працює програма, може дозволити тестувальникам безпеки визначити, чи є
програма вразливою до атак. Зокрема, сервери, на яких працюють старіші версії програмного забезпечення без оновлених
патчів безпеки, можуть бути вразливі до відомих версій експлойтів.

# Цілі тесту

- Визначте версію та тип запущеного веб-сервера, щоб уможливити подальше виявлення будь-яких відомих уразливостей.

# Як тестувати

Методи, які використовуються для відбитків пальців веб-сервера, включають захоплення банерів, отримання відповідей на
неправильно сформовані запити та використання автоматизованих інструментів для виконання надійніших сканувань із
використанням комбінації тактик. Основна передумова, за якою працюють усі ці методи, однакова. Усі вони прагнуть
отримати певну відповідь від веб-сервера, яку потім можна порівняти з базою даних відомих відповідей і поведінки, і
таким чином зіставити з відомим типом сервера.

## Захоплення банерів

Захоплення банера виконується шляхом надсилання HTTP-запиту на веб-сервер і перевірки його заголовка відповіді. Це можна
зробити за допомогою різноманітних інструментів, включаючи telnet для запитів HTTP або openssl для запитів через SSL.

Наприклад, ось відповідь на запит від сервера Apache.

```
HTTP/1.1 200 OK
Date: Thu, 05 Sep 2019 17:42:39 GMT
Server: Apache/2.4.41 (Unix)
Last-Modified: Thu, 05 Sep 2019 17:40:42 GMT
ETag: "75-591d1d21b6167"
Accept-Ranges: bytes
Content-Length: 117
Connection: close
Content-Type: text/html
```

Ось ще одна відповідь, цього разу від nginx.

```
HTTP/1.1 200 OK
Server: nginx/1.17.3
Date: Thu, 05 Sep 2019 17:50:24 GMT
Content-Type: text/html
Content-Length: 117
Last-Modified: Thu, 05 Sep 2019 17:40:42 GMT
Connection: close
ETag: "5d71489a-75"
Accept-Ranges: bytes
```

Ось як виглядає відповідь від lighttpd.

```
HTTP/1.0 200 OK
Content-Type: text/html
Accept-Ranges: bytes
ETag: "4192788355"
Last-Modified: Thu, 05 Sep 2019 17:40:42 GMT
Content-Length: 117
Connection: close
Date: Thu, 05 Sep 2019 17:57:57 GMT
Server: lighttpd/1.4.54
```

У цих прикладах чітко показано тип і версію сервера. Однак програми, які піклуються про безпеку, можуть маскувати
інформацію про сервер, змінюючи заголовок. Наприклад, ось уривок із відповіді на запит сайту зі зміненим шапкою:

```
HTTP/1.1 200 OK
Server: Website.com
Date: Thu, 05 Sep 2019 17:57:06 GMT
Content-Type: text/html; charset=utf-8
Status: 200 OK
```

У випадках, коли інформація про сервер прихована, тестувальники можуть здогадатися про тип сервера на основі порядку
полів заголовка. Зауважте, що у наведеному вище прикладі Apache поля дотримуються такого порядку:

- Дата
- Сервер
- Остання зміна
- ETag
- Прийняти діапазони
- Зміст-довжина
- Підключення
- Тип вмісту

Однак як у прикладах nginx, так і в прикладах закритого сервера, загальні поля мають такий порядок:

- Сервер
- Дата
- Тип вмісту

Тестери можуть використовувати цю інформацію, щоб здогадатися, що прихований сервер є nginx. Однак, враховуючи те, що
кілька різних веб-серверів можуть мати однаковий порядок полів і поля можна змінювати або видаляти, цей метод не є
остаточним.

## Надсилання неправильно сформованих запитів

Веб-сервери можна ідентифікувати, вивчивши їхні відповіді на помилки, а у випадках, коли вони не були налаштовані, їхні
сторінки помилок за замовчуванням. Один із способів змусити сервер представити їх — надіслати навмисно неправильні або
неправильно сформовані запити.

Наприклад, ось відповідь на запит неіснуючого методу SANTA CLAUS від сервера Apache.

```
GET / SANTA CLAUS/1.1


HTTP/1.1 400 Bad Request
Date: Fri, 06 Sep 2019 19:21:01 GMT
Server: Apache/2.4.41 (Unix)
Content-Length: 226
Connection: close
Content-Type: text/html; charset=iso-8859-1

<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<html><head>
<title>400 Bad Request</title>
</head><body>
<h1>Bad Request</h1>
<p>Your browser sent a request that this server could not understand.<br />
</p>
</body></html>
```

Ось відповідь на той самий запит від nginx.

```
GET / SANTA CLAUS/1.1


<html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>nginx/1.17.3</center>
</body>
</html>
```

Ось відповідь на той самий запит від lighttpd.

```
GET / SANTA CLAUS/1.1


HTTP/1.0 400 Bad Request
Content-Type: text/html
Content-Length: 345
Connection: close
Date: Sun, 08 Sep 2019 21:56:17 GMT
Server: lighttpd/1.4.54

<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
         "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
 <head>
  <title>400 Bad Request</title>
 </head>
 <body>
  <h1>400 Bad Request</h1>
 </body>
</html>
```

Оскільки сторінки помилок за замовчуванням пропонують багато відмінних факторів між типами веб-серверів, їх перевірка
може бути ефективним методом визначення відбитків пальців, навіть якщо поля заголовків сервера закриті.

## Використання інструментів автоматичного сканування

Як було сказано раніше, відбитки пальців веб-сервера часто входять до складу інструментів автоматичного сканування. Ці
інструменти можуть робити запити, подібні до тих, що продемонстровані вище, а також надсилати інші, більш специфічні для
сервера зонди. Автоматизовані інструменти можуть порівнювати відповіді від веб-серверів набагато швидше, ніж тестування
вручну, і використовувати великі бази даних відомих відповідей для спроби ідентифікації сервера. З цих причин
автоматизовані інструменти з більшою ймовірністю дають точні результати.

Ось кілька поширених інструментів сканування, які містять функцію відбитків пальців веб-сервера.

- Netcraft, онлайн-інструмент, який сканує веб-сайти на наявність інформації, включно з веб-сервером.
- Nikto, інструмент сканування командного рядка з відкритим кодом.
- Nmap, інструмент командного рядка з відкритим вихідним кодом, який також має графічний інтерфейс, Zenmap.

# Санація (Виправлення)

Хоча розкрита інформація сервера сама по собі не обов’язково є вразливістю, це інформація, яка може допомогти
зловмисникам використати інші вразливості, які можуть існувати. Розкрита інформація про сервер також може змусити
зловмисників знайти уразливості сервера, що стосуються певної версії, які можна використовувати для використання
невиправлених серверів. З цієї причини рекомендується вжити деяких запобіжних заходів. Ці дії включають:

- Приховування інформації веб-сервера в заголовках, наприклад, за допомогою модуля mod_headers Apache.
- Використання посиленого зворотного проксі-сервера для створення додаткового рівня безпеки між веб-сервером та
Інтернетом.
- Переконайтеся, що веб-сервери постійно оновлюються з найновішим програмним забезпеченням і виправленнями безпеки
